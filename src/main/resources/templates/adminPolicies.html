<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>All Policies - Admin</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<style>
		.header-gradient{background:linear-gradient(135deg,#0d6efd,#20c997);color:#fff;border-radius:.75rem;padding:1.25rem 1.5rem}
		.search-input{max-width:360px}
		.table thead th{white-space:nowrap}
	</style>
</head>
<body class="bg-light">
	<div class="container py-4">
		<div class="d-flex flex-wrap justify-content-between align-items-center mb-3 header-gradient gap-2">
			<div>
				<h3 class="mb-0">All Policies</h3>
				<small class="opacity-75">Overview of all policies in the system</small>
			</div>
			<div class="d-flex gap-2 align-items-center">
				<input id="policySearch" type="text" class="form-control form-control-sm search-input" placeholder="Search by user, email, policy #">
				<a href="/user/adminDashboard" class="btn btn-outline-light btn-sm">Back to Dashboard</a>
			</div>
		</div>

		<div class="card shadow-sm">
			<div class="card-body p-0">
				<div class="table-responsive">
					<table class="table table-striped table-hover align-middle mb-0" id="policiesTable">
						<thead class="table-light">
							<tr>
								<th>User ID</th>
								<th>Username</th>
								<th>Email</th>
								<th>Policy ID</th>
								<th>Coverage Amount</th>
								<th>Policy Number</th>
								<th>Policy Status</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="p : ${policies}">
								<td th:text="${p.policyholderId}">1</td>
								<td th:text="${userNameById[p.policyholderId]}">john</td>
								<td th:text="${emailById[p.policyholderId]}">john@example.com</td>
								<td th:text="${p.policyId}">10</td>
								<td th:text="${#numbers.formatDecimal(p.coverageAmount,1,2)}">0.00</td>
								<td th:text="${p.policyNumber}">POL-001</td>
								<td>
									<span class="badge bg-secondary" th:text="${p.policyStatus}">ACTIVE</span>
								</td>
							</tr>
							<tr th:if="${policies == null or #lists.isEmpty(policies)}">
								<td colspan="7" class="text-center text-muted py-4">No policies found.</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<script>
		const policySearch=document.getElementById('policySearch');
		policySearch?.addEventListener('input',()=>{
			const term=policySearch.value.toLowerCase();
			for(const row of document.querySelectorAll('#policiesTable tbody tr')){
				const text=row.innerText.toLowerCase();
				row.style.display=text.includes(term)?'':'none';
			}
		});
	</script>
</body>
</html> 